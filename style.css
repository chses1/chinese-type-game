:root{--bg:#081a3a;--accent:#ffd54a;--good:#2ecc71;--bad:#ff6b6b;--panel:#0f274f;--text:#eef5ff}
*{box-sizing:border-box;font-family:system-ui,-apple-system,"Noto Sans TC",Arial}
body{margin:0;background:radial-gradient(1200px 600px at 50% 110%,#0a2a5e,#050e22) fixed;color:var(--text)}
header {
  position:fixed;
  inset:0 0 auto 0;
  display:flex;
  gap:.5rem;
  align-items:center;
  padding:.5rem .7rem;
  background:linear-gradient(180deg,rgba(0,0,0,.35),rgba(0,0,0,0));
  z-index:5;

  justify-content:space-between; /* 平均分布 */
}

header .chip {
  flex:1;                      /* 每個 chip 同寬 */
  text-align:center;
  padding:.35rem .6rem;
  background:rgba(255,255,255,.08);
  border:1px solid rgba(255,255,255,.1);
  border-radius:999px;
  white-space:nowrap;           /* 避免換行 */
  overflow:hidden;              /* 超出隱藏 */
  text-overflow:ellipsis;       /* 超出顯示省略號 */
}

#chipHint {
  font-size:12px; 
  line-height:1.2;
  white-space:normal;           /* 提示允許斷行 */
}
#gameWrap{position:relative;min-height:100dvh;}
#gameCanvas {
  display:block;
  width:100%;
  height:58dvh;
  background:url("img/earth_bg.png") center bottom no-repeat;
  background-size:cover;   /* 拉滿整個畫布 */
  border-bottom:2px solid rgba(255,255,255,.08);
}

/* === keyboard === */
#kbd{
  position:fixed;left:0;right:0;bottom:0;z-index: 20;   /* 🔥 讓鍵盤浮在遊戲畫面上方 */
  padding:6px 8px 12px;
  background:linear-gradient(180deg,rgba(6,18,42,.8),rgba(6,18,42,.95));
  backdrop-filter:blur(6px);
  border-top:1px solid rgba(255,255,255,.08);
  max-height:42dvh;overflow:auto
}

/* 通用小按鈕：支援 <a> 與 <button> 皆可使用 .tag / .ghost */
.tag, a.tag, button.tag {
  display:inline-block; padding:10px 14px; border-radius:12px;
  background:rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.18);
  color:#fff; text-align:center; text-decoration:none; cursor:pointer;
}
.ghost, a.ghost, button.ghost {
  display:inline-block; padding:10px 14px; border-radius:12px;
  background:transparent; border:1px dashed rgba(255,255,255,.35);
  color:#fff; text-align:center; text-decoration:none; cursor:pointer;
}


/* 一列就是一行鍵盤，不換行；按鍵平均分配寬度 */
.row{
  display:flex;
  flex-wrap:nowrap;           /* 關鍵：避免自動掉到下一行 */
  justify-content:space-between;
  gap:8px;
  margin:8px auto
}

/* 按鍵等寬、等高；在不同鍵數的列仍可平均分配 */
.key{
  flex:1 1 0;                 /* 關鍵：每顆鍵平均分掉一行寬度 */
  min-width:0;                /* 允許更窄以避免擠壓換行 */
  min-height:44px;
  border-radius:12px;
  background:#102852;
  border:1px solid rgba(255,255,255,.12);
  color:#fff;
  font-size:22px;
  display:flex;align-items:center;justify-content:center;
  box-shadow:inset 0 -2px 0 rgba(0,0,0,.25)
}
.key:active{transform:translateY(1px)}
.key.big{flex:2 1 0}          /* 若未來需要加長鍵，可給 .big */

/* compact keyboard mode（縮小整體高度與字級） */
#kbd.compact{padding:4px 6px 10px}
#kbd.compact .row{gap:6px;margin:6px auto}
#kbd.compact .key{min-height:36px;border-radius:10px;font-size:18px}

/* 分群顏色 */
.key.shengmu{background:#133468;border-color:#2b8cff;box-shadow:inset 0 -2px 0 rgba(0,0,0,.25),0 0 0 2px rgba(43,140,255,.25)}
.key.medial{background:#154a3a;border-color:#23d39b;box-shadow:inset 0 -2px 0 rgba(0,0,0,.25),0 0 0 2px rgba(35,211,155,.25)}
.key.yunmu{background:#4a2b3c;border-color:#ff8cc8;box-shadow:inset 0 -2px 0 rgba(0,0,0,.25),0 0 0 2px rgba(255,140,200,.25)}

.legend .dot{display:inline-block;width:.9em;height:.9em;border-radius:50%;margin-right:.35em;vertical-align:-.12em}
.legend .dot.sm{background:#2b8cff}
.legend .dot.md{background:#23d39b}
.legend .dot.ym{background:#ff8cc8}

/* panels */
.panel{position:absolute;right:10px;top:70px;background:rgba(12,30,66,.75);border:1px solid rgba(255,255,255,.1);border-radius:12px;padding:10px 12px;backdrop-filter:blur(4px)}
.panel h3{margin:.2rem 0 .2rem 0;font-size:14px;opacity:.9}
.panel .stat{font-weight:700;color:var(--accent)}

/* ===== 成績視窗（已存在，略作微調） ===== */
#resultBox{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(0,0,0,.55); z-index:50; }
#resultCard{ width:min(460px,92vw); background:#0c2a57; border:2px solid rgba(255,255,255,.25); padding:22px; border-radius:16px; box-shadow:0 12px 30px rgba(0,0,0,.55); text-align:center; }
#resultCard h2{ margin:0 0 12px; color:var(--accent); }
#resultCard td{ padding:8px; }

/* login */
#login{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.45);z-index:20}
#card{width:min(440px,94vw);background:#0c2a57;border:1px solid rgba(255,255,255,.12);padding:18px;border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.4)}
label{display:block;font-size:14px;margin:4px 0 6px}
input,button,select{width:100%;padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,.18);background:#0b2148;color:#fff}
button.primary{background:linear-gradient(180deg,#2f7cff,#1b5bd1);border:none;font-weight:700}
button.ghost{background:transparent;border:1px dashed rgba(255,255,255,.35)}
.rowBtns{display:flex;gap:8px;margin-top:10px}

/* ===== 置中排行榜（NEW） ===== */
#leader{
  position:fixed;
  inset:0;
  display:none;                /* 由 JS 加上 .show 時才顯示 */
  align-items:center;
  justify-content:center;
  background:rgba(0,0,0,.55);
  z-index:40;
}
#leader.show{ display:flex; }

#leader table{
  border-collapse:collapse;
  background:rgba(12,30,66,.9);
  backdrop-filter:blur(8px);
  border:1px solid rgba(255,255,255,.18);
  border-radius:16px;
  overflow:hidden;
  min-width:min(92vw, 680px);
}
#leader th, #leader td{
  padding:14px 16px;           /* 放大 */
  border-bottom:1px solid rgba(255,255,255,.1);
  font-size:20px;              /* 放大字體 */
}
#leader th{ opacity:.85; font-weight:700; }

#leader + div button,           /* 排行榜下方兩顆按鈕區 */
#leader .tag{
  font-size:16px;
}

/* ===== Toast 放大 ===== */
.toast{ position:fixed; left:50%; transform:translateX(-50%); bottom:66dvh; background:rgba(0,0,0,.5); padding:16px 24px; border-radius:999px; border:1px solid rgba(255,255,255,.2); font-size:32px; font-weight:700; opacity:0; transition:opacity .25s; z-index:10; }
.toast.show{ opacity:1; }

/* 新增：估計抬頭高度，讓 canvas 填滿 header 下面到螢幕底部 */
:root{
  --headerH: 64px;         /* 視實際高度微調 56~72px 都可 */
}

/* 讓遊戲畫布延伸到底（在鍵盤後面），這樣鍵盤會蓋到畫布底部 */
#gameCanvas{
  display:block;
  width:100%;
  height: calc(90dvh - var(--headerH));  /* ⬅ 由原本 58dvh 改成填滿 */
  background: url("img/earth_bg.png") center calc(100% + var(--kbdShift)) no-repeat;
  background-size: cover;
  border-bottom: 2px solid rgba(255,255,255,.08);
}

/* 鍵盤高度/背景下移量（你已經有，保留即可；需要時微調） */
:root{
  --kbdH: 40dvh;
  --kbdShift: var(--kbdH);
}
@media (min-width: 768px){ :root{ --kbdH:36dvh; --kbdShift:var(--kbdH); } }
@media (min-width:1024px){ :root{ --kbdH:32dvh; --kbdShift:var(--kbdH); } }
@media (min-aspect-ratio:4/3) and (min-width:1280px){
  :root{ --kbdH:28dvh; --kbdShift:var(--kbdH); }
}

/* 鍵盤維持覆蓋最上層 */
#kbd{ max-height: var(--kbdH); z-index:20; }
